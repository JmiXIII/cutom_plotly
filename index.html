<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>My Grist Chart Widget</title>
    <!-- Include Plotly.js library -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
  </head>

  <body>
    <!-- Create a container element for the chart -->
    <div id="chart-container"></div>
    <script>
      console.log("Loaded Grist plugin API");
      console.log("typeof grist: ----->" + typeof grist);
      // Wait for the Grist API to be ready
      grist.ready();

      const table = grist.docApi.fetchTable("Animals");
      table.then((res) => {
        console.log(res);
        colsole.log(res.myColumnData);
      });
        ;

      // function toRecordMap(columnData) {
      //   const fieldNames = Object.keys(columnData);
      //   return new Map(
      //     columnData.id.map((id, index) => {
      //       const values = fieldNames.map((col) => [
      //         col,
      //         columnData[col][index],
      //       ]);
      //       return [id, Object.fromEntries(values)];
      //     })
      //   );
      // }

      // const m = toRecordMap(table);


      // // When a new record is selected in the Grist table, render a chart based on its data
      // grist.onRecord(function (record) {
      //   // Extract the data you need from the Grist record object
      //   const data = record.myDataColumn;
      //   console.log("table", table);

      //   // Define the trace for the chart
      //   const trace = {
      //     x: data,
      //     type: "bar",
      //   };

      //   // Define the layout of the chart
      //   const layout = {
      //     width: 400,
      //     height: 300,
      //     margin: { t: 0, r: 0, b: 30, l: 30 },
      //     xaxis: { title: "My Data" },
      //     yaxis: { title: "Count" },
      //   };

      //   // Create the chart using Plotly.js
      //   Plotly.newPlot("chart-container", [trace], layout);
      // });
    </script>
  </body>
</html>
